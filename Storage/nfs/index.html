<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>NFS数据共享服务 | 代码推演录</title><meta name="author" content="Aquarius"><meta name="copyright" content="Aquarius"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="1 NFS服务的工作原理NFS（Network File System，网络文件系统）是由 Sun 公司开发的基于内核的文件系统，其核心功能是允许用户和程序像访问本地文件一样访问远程系统上的文件。NFS 的实现依赖于 RPC（Remote Procedure Call Protocol，远程过程调用）协议 ——RPC 采用客户端 &#x2F; 服务器（C&#x2F;S）模式，客户端请求程序通过发送">
<meta property="og:type" content="article">
<meta property="og:title" content="NFS数据共享服务">
<meta property="og:url" content="https://aquapluto.github.io/Storage/nfs/">
<meta property="og:site_name" content="代码推演录">
<meta property="og:description" content="1 NFS服务的工作原理NFS（Network File System，网络文件系统）是由 Sun 公司开发的基于内核的文件系统，其核心功能是允许用户和程序像访问本地文件一样访问远程系统上的文件。NFS 的实现依赖于 RPC（Remote Procedure Call Protocol，远程过程调用）协议 ——RPC 采用客户端 &#x2F; 服务器（C&#x2F;S）模式，客户端请求程序通过发送">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://aquapluto.github.io/img/paper2.jpg">
<meta property="article:published_time" content="2025-08-20T08:52:20.000Z">
<meta property="article:modified_time" content="2025-09-09T09:25:12.983Z">
<meta property="article:author" content="Aquarius">
<meta property="article:tag" content="NFS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://aquapluto.github.io/img/paper2.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "NFS数据共享服务",
  "url": "https://aquapluto.github.io/Storage/nfs/",
  "image": "https://aquapluto.github.io/img/paper2.jpg",
  "datePublished": "2025-08-20T08:52:20.000Z",
  "dateModified": "2025-09-09T09:25:12.983Z",
  "author": [
    {
      "@type": "Person",
      "name": "Aquarius",
      "url": "https://AquaPluto.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://aquapluto.github.io/Storage/nfs/"><link rel="preconnect" href="//unpkg.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":true,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://unpkg.com/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'NFS数据共享服务',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/wave.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/background.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avator.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">138</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><div class="menus_items"><!-- 一级菜单项（非目录）--><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>计算机基础</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>计算机组成原理</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/ComputerBasic/computer-composition/hardware-composition/"><span>计算机硬件组成</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/ComputerBasic/computer-composition/CPU/"><span>CPU</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/ComputerBasic/computer-composition/memory/"><span>内存</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/ComputerBasic/computer-composition/hard-disk/"><span>硬盘</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>操作系统</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/ComputerBasic/operating-system/concept/"><span>操作系统的概念</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/ComputerBasic/operating-system/processes-threads/"><span>进程与线程</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/ComputerBasic/operating-system/IO-model/"><span>IO模型</span></a></li></ul></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>Linux</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>linux基础</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/basics/introduce/"><span>linux介绍</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/basics/file-structure-and-IO-redirects/"><span>文件结构与IO重定向</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/basics/file-command/"><span>文件管理工具</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/basics/text-command/"><span>文本管理工具</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/basics/GSA/"><span>文本处理三剑客</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/basics/user-permission/"><span>用户和权限管理</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/basics/regular-expression/"><span>正则表达式</span></a></li></ul></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Linux/software-manage/"><span>软件包管理</span></a></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>进程管理</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/process-manage/command/"><span>进程相关命令</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/process-manage/signal/"><span>信号发送</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/process-manage/job-parallel/"><span>作业管理与并行运行</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/process-manage/OOM/"><span>OOM</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>磁盘管理</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/disk-manage/disk-partition/"><span>磁盘分区</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/disk-manage/file-system/"><span>文件系统</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/disk-manage/swap/"><span>Swap分区</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/disk-manage/LVM/"><span>逻辑卷管理器LVM</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>网络管理</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/network-manage/configuration/"><span>网络配置</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/network-manage/test-diagnostic/"><span>网络测试诊断工具</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/network-manage/bridge/"><span>网桥配置</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/network-manage/troubleshoot/"><span>网络问题排查</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>服务管理</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/service-manage/DNS/"><span>域名DNS解析服务</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/service-manage/time-synchronization/"><span>时间同步服务</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/service-manage/plan-tasks/"><span>计划任务</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/service-manage/log/"><span>日志服务</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/service-manage/data-synchronization/"><span>数据的实时同步</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/service-manage/ssh/"><span>ssh远程连接服务</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/service-manage/mail/"><span>邮件服务</span></a></li></ul></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Linux/kernel-manage/"><span>内核和启动管理</span></a></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>防火墙</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/firewall/introduce/"><span>安全技术和防火墙</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/firewall/iptables/"><span>iptables</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/firewall/firewalld/"><span>firewalld</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/firewall/nft/"><span>nft</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>加密和安全</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/encryption-security/security-mechanisms/"><span>安全机制</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/encryption-security/OpenSSL/"><span>OpenSSL</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/encryption-security/sudo/"><span>sudo实现授权</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/encryption-security/PAM/"><span>PAM认证机制</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>shell编程</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/introduce/"><span>shell脚本介绍</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/variable/"><span>变量</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/operations-conditional/"><span>运算和条件测试</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/process-control/"><span>流程控制</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/function/"><span>函数</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/array/"><span>数组</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/string/"><span>字符串</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/script-tools/"><span>脚本相关工具</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/process-lock/"><span>进程锁</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/queue/"><span>队列实现线程并发控制</span></a></li></ul></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Linux/system-optimization/"><span>系统优化</span></a></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>数据库</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>MySQL</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/DataBase/MySQL/SQL/"><span>SQL语句</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Redis</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/DataBase/Redis/deploy/"><span>部署安装</span></a></li></ul></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>中间件</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Nginx</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Middleware/Nginx/111/"><span>111</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>HAProxy</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Middleware/HAProxy/111/"><span>111</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Keepalived</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Middleware/Keepalived/111/"><span>111</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Kafka</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Middleware/Kafka/111/"><span>111</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Tomcat</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Middleware/Tomcat/111/"><span>111</span></a></li></ul></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>日志</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/ELK/111/"><span>111</span></a></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>存储</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Storage/conspect/"><span>存储概论</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Storage/nfs/"><span>NFS</span></a></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>容器</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Container/basics/"><span>容器基础</span></a></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Docker</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Container/docker/conspect/"><span>Docker概论</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/docker/deploy/"><span>部署与配置</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/docker/image/"><span>镜像管理命令</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/docker/container/"><span>容器管理命令</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/docker/volume/"><span>数据卷</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/docker/network/"><span>网络管理</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/docker/compose/"><span>Docker-Compose</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>镜像</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Container/mirror/conspect/"><span>镜像概论</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/mirror/dockerfile/"><span>dockerfile</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/mirror/build/"><span>构建镜像</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/mirror/harbor/"><span>镜像仓库</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>容器进程</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Container/process/management/"><span>容器里的进程管理</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/process/cpu-cgroup/"><span>cpu cgroup使用</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/process/cpu-usage/"><span>监控容器真实的cpu使用率</span></a></li></ul></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Container/memory/"><span>容器内存</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Container/storage/"><span>容器存储</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Container/network/"><span>容器网络</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Container/safe/"><span>容器安全</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Container/containerd/"><span>Containerd</span></a></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>K8s</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Kubernetes概论</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/conspect/architecture/"><span>Kubernetes架构</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/conspect/cri/"><span>容器运行时接口CRI</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/conspect/list-watch/"><span>List-Watch机制</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/conspect/object/"><span>Kubernetes对象</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/conspect/namespace/"><span>Namespace</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/conspect/kubectl/"><span>kubectl命令</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>部署安装</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/deploy/explanation/"><span>部署说明</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/deploy/docker/"><span>基于docker部署k8s-v1.30</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/deploy/containerd/"><span>基于containerd部署k8s-v1.30</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/deploy/cluster/"><span>集群管理指南</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Pod</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/pod/conspect/"><span>Pod概论</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/pod/configuration/"><span>Pod的配置</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/pod/schedule/"><span>Pod的调度</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/pod/eviction/"><span>Pod的驱逐</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>控制器</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/controller/introduce/"><span>控制器介绍</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/controller/deployment/"><span>Deployment</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/controller/statefulset/"><span>StatefulSet</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/controller/daemonset/"><span>DaemonSet</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/controller/job-cronjob/"><span>Job和CronJob</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/controller/HPA/"><span>HPA</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/controller/operator/"><span>Operator</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>服务发现与负载均衡</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/service-loadbalancer/service/"><span>Service</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/service-loadbalancer/ingress/"><span>Ingress</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/service-loadbalancer/coredns/"><span>CoreDNS</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/service-loadbalancer/localdns/"><span>LocalDNS</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>数据存储持久化</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/data-storage/csi/"><span>存储接口CSI</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/data-storage/pv-pvc/"><span>PV和PVC</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/data-storage/storageclass/"><span>StorageClass</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/data-storage/configmap-secret/"><span>ConfigMap和Secret</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>认证与鉴权体系</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/certification-authentication/conspect/"><span>体系概论</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/certification-authentication/kubeconfig/"><span>kubeconfig</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/certification-authentication/user-account/"><span>User Account</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/certification-authentication/service-account/"><span>Service Account</span></a></li></ul></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>监控</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Monitor/conspect/"><span>监控概论</span></a></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Prometheus</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/introduce/"><span>prometheus概述</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/deploy/"><span>部署与配置</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/exporter/"><span>Exporter</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/promql/"><span>PromQL</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/query-persist/"><span>查询结果持久化</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/service-discovery/"><span>服务发现</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/indicators-remarked/"><span>指标重新打标</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/pushmanager/"><span>Pushmanager</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/cluster-ha/"><span>集群与高可用</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Alertmanager</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/alertmanager/introduce/"><span>告警功能概述</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/alertmanager/deploy/"><span>部署与配置</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/alertmanager/alarm/"><span>实现告警功能</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/alertmanager/ha/"><span>高可用架构</span></a></li></ul></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Monitor/grafana/"><span>Grafana</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Monitor/streaming/"><span>基于流处理的可观测性架构</span></a></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>CICD</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Ansible</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/CICD/ansible/introduce/"><span>架构概述</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/CICD/ansible/deploy/"><span>部署与配置</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/CICD/ansible/command/"><span>相关命令</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/CICD/ansible/module/"><span>常用模块</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/CICD/ansible/playbook/"><span>PlayBook</span></a></li></ul></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>SRE</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/SRE/111/"><span>111</span></a></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>Python</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/python/111/"><span>python基础</span></a></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>线性表</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/python/111/"><span>列表</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/python/111/"><span>元组</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/python/111/"><span>字符串</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>哈希表</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/python/111/"><span>封装与解构</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/python/111/"><span>集合</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/python/111/"><span>字典</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/python/111/"><span>解析式与生成器表达式</span></a></li></ul></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/python/111/"><span>函数</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/python/111/"><span>IO操作</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/python/111/"><span>面向对象编程</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/python/111/"><span>并发编程</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/python/111/"><span>网络编程</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/python/111/"><span>数据库编程</span></a></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>Django</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/ELK/111/"><span>111</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/paper2.jpg);"><nav id="nav"><!-- 左侧博客信息区域--><span id="blog-info"><a class="nav-site-title" href="/"></a><a class="nav-page-title" href="/"><span class="site-name">NFS数据共享服务</span></a></span><!-- 新增的导航菜单容器（居中布局关键）--><div id="nav-menus-container"><!-- 菜单主体部分--><div id="menus"><!-- 菜单项--><div class="menus_items"><!-- 一级菜单项（非目录）--><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>计算机基础</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>计算机组成原理</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/ComputerBasic/computer-composition/hardware-composition/"><span>计算机硬件组成</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/ComputerBasic/computer-composition/CPU/"><span>CPU</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/ComputerBasic/computer-composition/memory/"><span>内存</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/ComputerBasic/computer-composition/hard-disk/"><span>硬盘</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>操作系统</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/ComputerBasic/operating-system/concept/"><span>操作系统的概念</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/ComputerBasic/operating-system/processes-threads/"><span>进程与线程</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/ComputerBasic/operating-system/IO-model/"><span>IO模型</span></a></li></ul></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>Linux</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>linux基础</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/basics/introduce/"><span>linux介绍</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/basics/file-structure-and-IO-redirects/"><span>文件结构与IO重定向</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/basics/file-command/"><span>文件管理工具</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/basics/text-command/"><span>文本管理工具</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/basics/GSA/"><span>文本处理三剑客</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/basics/user-permission/"><span>用户和权限管理</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/basics/regular-expression/"><span>正则表达式</span></a></li></ul></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Linux/software-manage/"><span>软件包管理</span></a></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>进程管理</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/process-manage/command/"><span>进程相关命令</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/process-manage/signal/"><span>信号发送</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/process-manage/job-parallel/"><span>作业管理与并行运行</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/process-manage/OOM/"><span>OOM</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>磁盘管理</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/disk-manage/disk-partition/"><span>磁盘分区</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/disk-manage/file-system/"><span>文件系统</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/disk-manage/swap/"><span>Swap分区</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/disk-manage/LVM/"><span>逻辑卷管理器LVM</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>网络管理</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/network-manage/configuration/"><span>网络配置</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/network-manage/test-diagnostic/"><span>网络测试诊断工具</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/network-manage/bridge/"><span>网桥配置</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/network-manage/troubleshoot/"><span>网络问题排查</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>服务管理</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/service-manage/DNS/"><span>域名DNS解析服务</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/service-manage/time-synchronization/"><span>时间同步服务</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/service-manage/plan-tasks/"><span>计划任务</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/service-manage/log/"><span>日志服务</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/service-manage/data-synchronization/"><span>数据的实时同步</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/service-manage/ssh/"><span>ssh远程连接服务</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/service-manage/mail/"><span>邮件服务</span></a></li></ul></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Linux/kernel-manage/"><span>内核和启动管理</span></a></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>防火墙</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/firewall/introduce/"><span>安全技术和防火墙</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/firewall/iptables/"><span>iptables</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/firewall/firewalld/"><span>firewalld</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/firewall/nft/"><span>nft</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>加密和安全</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/encryption-security/security-mechanisms/"><span>安全机制</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/encryption-security/OpenSSL/"><span>OpenSSL</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/encryption-security/sudo/"><span>sudo实现授权</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/encryption-security/PAM/"><span>PAM认证机制</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>shell编程</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/introduce/"><span>shell脚本介绍</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/variable/"><span>变量</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/operations-conditional/"><span>运算和条件测试</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/process-control/"><span>流程控制</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/function/"><span>函数</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/array/"><span>数组</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/string/"><span>字符串</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/script-tools/"><span>脚本相关工具</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/process-lock/"><span>进程锁</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Linux/shell/queue/"><span>队列实现线程并发控制</span></a></li></ul></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Linux/system-optimization/"><span>系统优化</span></a></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>数据库</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>MySQL</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/DataBase/MySQL/SQL/"><span>SQL语句</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Redis</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/DataBase/Redis/deploy/"><span>部署安装</span></a></li></ul></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>中间件</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Nginx</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Middleware/Nginx/111/"><span>111</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>HAProxy</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Middleware/HAProxy/111/"><span>111</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Keepalived</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Middleware/Keepalived/111/"><span>111</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Kafka</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Middleware/Kafka/111/"><span>111</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Tomcat</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Middleware/Tomcat/111/"><span>111</span></a></li></ul></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>日志</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/ELK/111/"><span>111</span></a></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>存储</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Storage/conspect/"><span>存储概论</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Storage/nfs/"><span>NFS</span></a></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>容器</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Container/basics/"><span>容器基础</span></a></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Docker</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Container/docker/conspect/"><span>Docker概论</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/docker/deploy/"><span>部署与配置</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/docker/image/"><span>镜像管理命令</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/docker/container/"><span>容器管理命令</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/docker/volume/"><span>数据卷</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/docker/network/"><span>网络管理</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/docker/compose/"><span>Docker-Compose</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>镜像</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Container/mirror/conspect/"><span>镜像概论</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/mirror/dockerfile/"><span>dockerfile</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/mirror/build/"><span>构建镜像</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/mirror/harbor/"><span>镜像仓库</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>容器进程</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Container/process/management/"><span>容器里的进程管理</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/process/cpu-cgroup/"><span>cpu cgroup使用</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Container/process/cpu-usage/"><span>监控容器真实的cpu使用率</span></a></li></ul></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Container/memory/"><span>容器内存</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Container/storage/"><span>容器存储</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Container/network/"><span>容器网络</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Container/safe/"><span>容器安全</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Container/containerd/"><span>Containerd</span></a></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>K8s</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Kubernetes概论</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/conspect/architecture/"><span>Kubernetes架构</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/conspect/cri/"><span>容器运行时接口CRI</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/conspect/list-watch/"><span>List-Watch机制</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/conspect/object/"><span>Kubernetes对象</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/conspect/namespace/"><span>Namespace</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/conspect/kubectl/"><span>kubectl命令</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>部署安装</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/deploy/explanation/"><span>部署说明</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/deploy/docker/"><span>基于docker部署k8s-v1.30</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/deploy/containerd/"><span>基于containerd部署k8s-v1.30</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/deploy/cluster/"><span>集群管理指南</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Pod</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/pod/conspect/"><span>Pod概论</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/pod/configuration/"><span>Pod的配置</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/pod/schedule/"><span>Pod的调度</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/pod/eviction/"><span>Pod的驱逐</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>控制器</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/controller/introduce/"><span>控制器介绍</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/controller/deployment/"><span>Deployment</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/controller/statefulset/"><span>StatefulSet</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/controller/daemonset/"><span>DaemonSet</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/controller/job-cronjob/"><span>Job和CronJob</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/controller/HPA/"><span>HPA</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/controller/operator/"><span>Operator</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>服务发现与负载均衡</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/service-loadbalancer/service/"><span>Service</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/service-loadbalancer/ingress/"><span>Ingress</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/service-loadbalancer/coredns/"><span>CoreDNS</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/service-loadbalancer/localdns/"><span>LocalDNS</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>数据存储持久化</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/data-storage/csi/"><span>存储接口CSI</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/data-storage/pv-pvc/"><span>PV和PVC</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/data-storage/storageclass/"><span>StorageClass</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/data-storage/configmap-secret/"><span>ConfigMap和Secret</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>认证与鉴权体系</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/certification-authentication/conspect/"><span>体系概论</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/certification-authentication/kubeconfig/"><span>kubeconfig</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/certification-authentication/user-account/"><span>User Account</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Kubernetes/certification-authentication/service-account/"><span>Service Account</span></a></li></ul></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>监控</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Monitor/conspect/"><span>监控概论</span></a></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Prometheus</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/introduce/"><span>prometheus概述</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/deploy/"><span>部署与配置</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/exporter/"><span>Exporter</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/promql/"><span>PromQL</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/query-persist/"><span>查询结果持久化</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/service-discovery/"><span>服务发现</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/indicators-remarked/"><span>指标重新打标</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/pushmanager/"><span>Pushmanager</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/prometheus/cluster-ha/"><span>集群与高可用</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Alertmanager</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/alertmanager/introduce/"><span>告警功能概述</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/alertmanager/deploy/"><span>部署与配置</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/alertmanager/alarm/"><span>实现告警功能</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/Monitor/alertmanager/ha/"><span>高可用架构</span></a></li></ul></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Monitor/grafana/"><span>Grafana</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/Monitor/streaming/"><span>基于流处理的可观测性架构</span></a></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>CICD</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>Ansible</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/CICD/ansible/introduce/"><span>架构概述</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/CICD/ansible/deploy/"><span>部署与配置</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/CICD/ansible/command/"><span>相关命令</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/CICD/ansible/module/"><span>常用模块</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/CICD/ansible/playbook/"><span>PlayBook</span></a></li></ul></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>SRE</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/SRE/111/"><span>111</span></a></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>Python</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/python/111/"><span>python基础</span></a></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>线性表</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/python/111/"><span>列表</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/python/111/"><span>元组</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/python/111/"><span>字符串</span></a></li></ul></li><!-- 二级目录（包含三级菜单）--><li class="menus_item_second"><span class="site-page group second"><span>哈希表</span><i class="fas fa-chevron-right"></i></span><ul class="menus_item_child_second"><!-- 三级菜单项--><li><a class="site-page third" href="/python/111/"><span>封装与解构</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/python/111/"><span>集合</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/python/111/"><span>字典</span></a></li><!-- 三级菜单项--><li><a class="site-page third" href="/python/111/"><span>解析式与生成器表达式</span></a></li></ul></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/python/111/"><span>函数</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/python/111/"><span>IO操作</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/python/111/"><span>面向对象编程</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/python/111/"><span>并发编程</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/python/111/"><span>网络编程</span></a></li><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/python/111/"><span>数据库编程</span></a></li></ul></div><!-- 一级目录（包含二级菜单）--><div class="menus_item"><span class="site-page group"><span>Django</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><!-- 二级菜单项（非目录）--><li><a class="site-page child" href="/ELK/111/"><span>111</span></a></li></ul></div></div></div></div><!-- 右侧功能区域（新增容器）--><div id="nav-right-container"><!-- 搜索按钮（移动到右侧）--><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i></span></div><!-- 移动端汉堡菜单按钮--><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">NFS数据共享服务</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-08-20T08:52:20.000Z" title="发表于 2025-08-20 16:52">2025-08-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-09T09:25:12.983Z" title="更新于 2025-09-09 17:25">2025-09-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%98%E5%82%A8/">存储</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">6.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>32分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="1-NFS服务的工作原理"><a href="#1-NFS服务的工作原理" class="headerlink" title="1 NFS服务的工作原理"></a>1 NFS服务的工作原理</h1><p>NFS（Network File System，网络文件系统）是由 Sun 公司开发的基于内核的文件系统，其核心功能是允许用户和程序像访问本地文件一样访问远程系统上的文件。NFS 的实现依赖于 RPC（Remote Procedure Call Protocol，远程过程调用）协议 ——RPC 采用客户端 &#x2F; 服务器（C&#x2F;S）模式，客户端请求程序通过发送包含进程参数的调用信息到服务进程以获取服务，服务器进程则在接收请求后计算结果并返回应答，客户端再根据应答继续执行后续操作。</p>
<p>NFS 的显著优势在于节省本地存储空间：例如，可将常用数据（如<code>/home</code>目录）集中存储在 NFS 服务器上，本地终端通过网络访问即可，无需占用自身存储。一个简单的应用场景是：服务器 A 将<code>/data/</code>目录通过 NFS 共享，客户端 B 将其挂载到本地<code>/tmp</code>目录，此时 B 在<code>/tmp</code>中写入的数据实际存储在 A 的<code>/data/</code>中；同时，A 直接向<code>/data/</code>写入的数据，B 也可通过<code>/tmp</code>目录实时访问，实现了跨主机的文件共享与协同操作。</p>
<p>注册中心：假设Aserver对外提供web服务，它的地址通过容器的方法实现，地址自动分配，不固定，用户想访问没办法直接访问，所以Aserver启动后，就会把地址向注册中心进行注册，用户就可以向注册中心寻找自己想要的服务查找IP地址</p>
<p><img src="/Storage/nfs/1753757618938-d9f6204f-b197-48fc-8002-a6c166fb43ef-17556838846746.png" alt="null"></p>
<p>由于 NFS 服务的端口不固定，其启动时会将自身端口号向 RPC 服务注册，而 RPC 服务的端口号固定为 111。因此，当用户需要访问 NFS 服务时，会先访问 111 端口的 RPC 服务，查询 NFS 当前的端口号，获取端口后即可直接与 NFS 服务建立连接并进行数据访问，这一过程类似 “注册中心” 的机制 —— 就像服务 A 启动后向注册中心注册地址，用户通过注册中心查询地址再访问服务一样，NFS 通过 RPC 完成端口的 “注册与查询”，解决了端口不固定导致的访问问题。</p>
<p><img src="/Storage/nfs/1753757619043-bfa486f3-2fd7-4ecf-af1d-c7e8e654b97b-17556838846745.png" alt="null"></p>
<h1 id="2-NFS软件包"><a href="#2-NFS软件包" class="headerlink" title="2 NFS软件包"></a>2 NFS软件包</h1><p>由于NFS 基于 C&#x2F;S 模式实现，所以有客户端软件和服务端软件。红帽系统和Ubuntu的NFS软件包名不一样，除了安装NFS软件包，还需要确保 rpcbind（必须）和 tcp_wrappers（非必须）已安装，通常它们可能作为依赖自动安装</p>
<ul>
<li><p>红帽系统：nfs-utils，包括服务器和客户端相关工具</p>
</li>
<li><p>Ubuntu：nfs-server 服务器包名，nfs-common 客户端包名</p>
</li>
</ul>
<p>NFS服务主要进程：</p>
<ul>
<li><p><code>rpc.nfsd</code>：最主要的NFS进程，管理客户端是否可登录</p>
</li>
<li><p><code>rpc.mountd</code>：挂载和卸载NFS文件系统，包括权限管理</p>
</li>
<li><p><code>rpc.lockd</code>：非必要，管理文件锁，避免同时写出错</p>
</li>
<li><p><code>rpc.statd</code>：非必要，检查文件一致性，可修复文件</p>
</li>
</ul>
<p>NFS 服务的端口分为固定与动态两部分：其核心进程<code>nfsd</code>使用固定端口 2049（TCP&#x2F;UDP），而其他关键进程（如负责挂载管理的<code>rpc.mountd</code>、文件锁管理的<code>rpc.lockd</code>等）的端口是动态分配的。这些动态端口会在 NFS 服务启动时向<code>rpcbind</code>（端口 111，TCP&#x2F;UDP）注册，<code>rpcbind</code>作为 “端口注册中心”，负责记录并向客户端提供这些动态端口的信息。因此，客户端访问 NFS 时，需先通过 111 端口查询<code>rpcbind</code>获取动态端口，再结合固定的 2049 端口完成连接。</p>
<p>NFS相关文件</p>
<ul>
<li><code>/etc/exports</code>：共享规则配置文件（全局）</li>
<li><code>/etc/exports.d/*.exports</code>：按业务创建规则（局部），后缀必须为exports</li>
<li><code>/var/lib/nfs/</code>：日志文件</li>
</ul>
<p>红帽系统安装NFS软件包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@centos8 ~]#yum -y install nfs-utils</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看支持的NFS版本,注意:只有服务启动才能看此文件</span></span><br><span class="line">[root@centos8 ~]#<span class="built_in">cat</span> /proc/fs/nfsd/versions</span><br><span class="line">-2 +3 +4 +4.1 +4.2</span><br><span class="line"></span><br><span class="line">[root@centos8 ~]#systemctl <span class="built_in">enable</span> --now nfs-server.service</span><br></pre></td></tr></table></figure>

<p>Ubuntu 安装NFS软件包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#服务器</span></span><br><span class="line">[root@ubuntu2004 ~]#apt update &amp;&amp; apt -y install nfs-kernel-server</span><br><span class="line">[root@ubuntu2004 ~]#systemctl status nfs-server</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看支持的NFS版本,注意:只有服务启动才能看此文件</span></span><br><span class="line">[root@ubuntu2004 ~]#<span class="built_in">cat</span> /proc/fs/nfsd/versions</span><br><span class="line">-2 +3 +4 +4.1 +4.2</span><br><span class="line"></span><br><span class="line"><span class="comment">#客户端</span></span><br><span class="line">[root@ubuntu2004 ~]#apt -y install nfs-common</span><br></pre></td></tr></table></figure>

<p>服务端依赖包，注册中心，NFS服务中有大量的组件，部份组件端口并不固定，需要依赖 rpcbind 发布端口</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">[root@ubuntu ~]# dpkg -l rpcbind</span><br><span class="line">Desired=Unknown/Install/Remove/Purge/Hold</span><br><span class="line">| Status=Not/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend</span><br><span class="line">|/ Err?=(none)/Reinst-required (Status,Err: uppercase=bad)</span><br><span class="line">||/ Name      Version    Architecture Description</span><br><span class="line">+++-==============-=============-============-</span><br><span class="line">=====================================================</span><br><span class="line">ii rpcbind     1.2.6-2build1 amd64    converts RPC program numbers into universal addresses</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看服务端端口</span></span><br><span class="line">[root@ubuntu ~]# ss -tunlp | grep rpc</span><br><span class="line">udp UNCONN 0  0   127.0.0.1:603   0.0.0.0:* <span class="built_in">users</span>:((&quot;rpc.statd&quot;,pid=<span class="number">14843</span>,fd=<span class="number">5</span>))</span><br><span class="line">udp UNCONN 0  0    0.0.0.0:38632  0.0.0.0:* <span class="built_in">users</span>:((&quot;rpc.statd&quot;,pid=<span class="number">14843</span>,fd=<span class="number">8</span>))</span><br><span class="line">udp UNCONN 0  0    0.0.0.0:58332  0.0.0.0:* <span class="built_in">users</span>:((&quot;rpc.mountd&quot;,pid=<span class="number">15464</span>,fd=<span class="number">4</span>))</span><br><span class="line">udp UNCONN 0  0    0.0.0.0:54239  0.0.0.0:* <span class="built_in">users</span>:((&quot;rpc.mountd&quot;,pid=<span class="number">15464</span>,fd=<span class="number">12</span>))</span><br><span class="line">udp UNCONN 0  0    0.0.0.0:48141  0.0.0.0:* <span class="built_in">users</span>:((&quot;rpc.mountd&quot;,pid=<span class="number">15464</span>,fd=<span class="number">8</span>))</span><br><span class="line">udp UNCONN 0  0    0.0.0.0:111    0.0.0.0:* <span class="built_in">users</span>:((&quot;rpcbind&quot;,pid=<span class="number">14257</span>,fd=<span class="number">5</span>),(&quot;systemd&quot;,pid=<span class="number">1</span>,fd=<span class="number">138</span>))</span><br><span class="line">....</span><br><span class="line"></span><br><span class="line"><span class="comment">#重启服务</span></span><br><span class="line">[root@ubuntu ~]# systemctl restart nfs-server.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#再次查看端口，端口发生了变化</span></span><br><span class="line">[root@ubuntu ~]# ss -tunlp | grep rpc</span><br><span class="line">udp UNCONN 0  0    0.0.0.0:36333  0.0.0.0:* <span class="built_in">users</span>:((&quot;rpc.mountd&quot;,pid=<span class="number">15507</span>,fd=<span class="number">12</span>))</span><br><span class="line">udp UNCONN 0  0   127.0.0.1:603   0.0.0.0:* <span class="built_in">users</span>:((&quot;rpc.statd&quot;,pid=<span class="number">14843</span>,fd=<span class="number">5</span>))</span><br><span class="line">udp UNCONN 0  0    0.0.0.0:38632  0.0.0.0:* <span class="built_in">users</span>:((&quot;rpc.statd&quot;,pid=<span class="number">14843</span>,fd=<span class="number">8</span>))</span><br><span class="line">udp UNCONN 0  0    0.0.0.0:111    0.0.0.0:* <span class="built_in">users</span>:((&quot;rpcbind&quot;,pid=<span class="number">14257</span>,fd=<span class="number">5</span>),(&quot;systemd&quot;,pid=<span class="number">1</span>,fd=<span class="number">138</span>))</span><br><span class="line">udp UNCONN 0  0    0.0.0.0:48272  0.0.0.0:* <span class="built_in">users</span>:((&quot;rpc.mountd&quot;,pid=<span class="number">15507</span>,fd=<span class="number">4</span>))</span><br><span class="line">udp UNCONN 0  0    0.0.0.0:38052  0.0.0.0:* <span class="built_in">users</span>:((&quot;rpc.mountd&quot;,pid=<span class="number">15507</span>,fd=<span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#由于服务端监听的端口会发生变化，所以需要依赖rpcbind对客户端提供注册服务，rpcbind端口不会发生变化</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看服务端使用的端口</span></span><br><span class="line">[root@ubuntu ~]# rpcinfo -p</span><br><span class="line"> program vers proto  port  service</span><br><span class="line">  100000   4  tcp   111 portmapper  <span class="comment">#rpcbind，早期叫portmapper</span></span><br><span class="line">  ....</span><br></pre></td></tr></table></figure>

<h1 id="3-NFS共享配置文件格式"><a href="#3-NFS共享配置文件格式" class="headerlink" title="3 NFS共享配置文件格式"></a>3 NFS共享配置文件格式</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/dir 客户端主机1(opt1,opt2) 客户端主机2(opt1,opt2)...</span><br><span class="line"></span><br><span class="line">/dir				<span class="comment">#NFS服务器上要被共享的目录路径</span></span><br><span class="line">客户端主机    <span class="comment">#可以共享此目录的客户端主机</span></span><br><span class="line">opt					<span class="comment">#配置项</span></span><br></pre></td></tr></table></figure>

<p>客户端主机格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">anonymous  <span class="comment"># *表示不限制，即任何主机都能访问</span></span><br><span class="line">单个主机    <span class="comment">#可以写具体的IPV4,IPV6，FQDN，主机名</span></span><br><span class="line"></span><br><span class="line">IP networks（网段） <span class="comment">#两种掩码格式均支持</span></span><br><span class="line">172.18.0.0/255.255.0.0</span><br><span class="line">172.18.0.0/16</span><br><span class="line"></span><br><span class="line">wildcards 	<span class="comment">#主机名通配，例如:*.wang.org，IP不可以</span></span><br><span class="line">netgroups 	<span class="comment">#NIS域的主机组，@group_name</span></span><br><span class="line">gss/krb5i 	<span class="comment">#这种写法来限制对使用rpcsec_gss安全性的客户端的访问</span></span><br></pre></td></tr></table></figure>

<p>opt配置项</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">默认选项：(ro,<span class="built_in">sync</span>,root_squash,no_all_squash)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问权限控制</span></span><br><span class="line">ro                    <span class="comment"># 只读</span></span><br><span class="line">rw                    <span class="comment"># 读写</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 同步/异步写入</span></span><br><span class="line"><span class="built_in">sync</span>                  <span class="comment"># 同步写入，数据在请求时立即写入共享存储磁盘（默认，性能低，安全性高）</span></span><br><span class="line">async                 <span class="comment"># 异步写入，先写入缓冲区，过一段时间再写入磁盘（性能高，安全性低）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用户映射与匿名控制</span></span><br><span class="line">root_squash           <span class="comment"># （默认）将远程客户端主机上的root用户映射为nfsnobody,UID为65534的用户，CentOS8为nobody</span></span><br><span class="line">no_root_squash        <span class="comment"># 不映射远程root用户，保留其root权限</span></span><br><span class="line">all_squash            <span class="comment"># 所有远程客户端主机上的用户均映射为匿名用户（UID 65534），此项会覆盖no_root_squash</span></span><br><span class="line">no_all_squash         <span class="comment"># （默认）保留客户端用户的原始UID和GID</span></span><br><span class="line">anonuid               <span class="comment"># 指定匿名用户的UID（配合all_squash使用），注意:目录需要给此用户权限,否则无法访问	</span></span><br><span class="line">anongid               <span class="comment"># 指定匿名用户的GID（配合all_squash使用）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查父目录权限</span></span><br><span class="line">subtree_check         <span class="comment"># 如果共享子目录，强制NFS检查父目录权限</span></span><br><span class="line">no_subtree_check      <span class="comment"># 不检查父目录权限，提升性能</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入延迟控制</span></span><br><span class="line">wdelay                <span class="comment"># （默认）等待多个写操作合并后一起写入</span></span><br><span class="line">no_wdelay             <span class="comment"># 立即写入，不等待；使用async时自动启用</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 目录可见性控制</span></span><br><span class="line">hide                  <span class="comment"># 不共享NFS服务器上的子目录（NFSv4无效）</span></span><br><span class="line">no_hide               <span class="comment"># 共享NFS服务器上的子目录（NFSv4无效）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安全与端口设置</span></span><br><span class="line">secure                <span class="comment"># 仅允许1024以下的特权端口连接</span></span><br><span class="line">insecure              <span class="comment"># 允许1024以上的非特权端口连接（常见于NFSv3客户端）</span></span><br><span class="line">insecure NFS          <span class="comment"># 服务通过1024以上的TCP/IP端口通信</span></span><br></pre></td></tr></table></figure>

<p>范例：NFS配置示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@centos8 ~]#vim /etc/exports</span><br><span class="line">/myshare server.example.com</span><br><span class="line">/myshare *.example.com</span><br><span class="line">/myshare server?.example.com</span><br><span class="line">/myshare server[0-20].example.com</span><br><span class="line">/myshare 172.25.11.10</span><br><span class="line">/myshare 172.25.0.0/16</span><br><span class="line">/myshare 2000:472:18:b51:c32:a21</span><br><span class="line">/myshare 2000:472:18:b51::/64</span><br><span class="line">/myshare *.example.com 172.25.0.0/16</span><br><span class="line">/myshare desktop.example.com(ro)</span><br><span class="line">/myshare desktop.example.com(ro) server[0-20].example.com(rw)</span><br><span class="line">/myshare diskless.example.com(rw,no_root_squash)</span><br></pre></td></tr></table></figure>

<p>范例：默认挂载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#服务器</span></span><br><span class="line">[root@ubuntu ~]# <span class="built_in">mkdir</span> /data/dir&#123;a,b&#125;</span><br><span class="line">[root@ubuntu ~]# <span class="built_in">cp</span> /etc/fstab /data/dira/</span><br><span class="line">[root@ubuntu ~]# <span class="built_in">cat</span> /etc/exports</span><br><span class="line">/data/dira  *</span><br><span class="line"></span><br><span class="line"><span class="comment">#读取配置，生效</span></span><br><span class="line">[root@ubuntu ~]# exportfs -r</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看</span></span><br><span class="line">[root@ubuntu ~]# exportfs -v</span><br><span class="line">/data/dira  &lt;world&gt;</span><br><span class="line">(<span class="built_in">sync</span>,wdelay,hide,no_subtree_check,sec=sys,ro,secure,root_squash,no_all_squash)</span><br><span class="line"></span><br><span class="line">[root@ubuntu ~]# mount</span><br><span class="line">10.0.0.208:/data/dira on /data/dir1 <span class="built_in">type</span> nfs4</span><br><span class="line">(ro,relatime,vers=4.2,rsize=262144,wsize=262144,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,clientaddr=10.0.0.206,local_lock=none,addr=10.0.0.208)</span><br><span class="line"></span><br><span class="line"><span class="comment">#在客户端</span></span><br><span class="line"><span class="comment">#查看NFS服务器上有什么共享文件夹</span></span><br><span class="line">[root@ubuntu ~]# showmount -e 10.0.0.208</span><br><span class="line">Export list <span class="keyword">for</span> 10.0.0.208:</span><br><span class="line">/data/dira *</span><br><span class="line"></span><br><span class="line">[root@ubuntu ~]# <span class="built_in">mkdir</span> -pv /data/dir&#123;1,2&#125;</span><br><span class="line"><span class="built_in">mkdir</span>: created directory <span class="string">&#x27;/data&#x27;</span></span><br><span class="line"><span class="built_in">mkdir</span>: created directory <span class="string">&#x27;/data/dir1&#x27;</span></span><br><span class="line"><span class="built_in">mkdir</span>: created directory <span class="string">&#x27;/data/dir2&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将远程主机上的 /data/dira 目录挂载到本机的 /data/dir1 上</span></span><br><span class="line">[root@ubuntu ~]# mount 10.0.0.208:/data/dira /data/dir1</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看</span></span><br><span class="line">[root@ubuntu ~]# <span class="built_in">df</span> -h /data/dir1/</span><br><span class="line">Filesystem       Size Used Avail Use% Mounted on</span><br><span class="line">10.0.0.208:/data/dira  97G  7.4G  85G  9% /data/dir1</span><br><span class="line"></span><br><span class="line">[root@ubuntu ~]# <span class="built_in">ls</span> -l /data/dir1</span><br><span class="line">total 4</span><br><span class="line">-rw-r--r-- 1 root root 657 Jul  9 09:58 fstab</span><br><span class="line"></span><br><span class="line"><span class="comment">#可读</span></span><br><span class="line">[root@ubuntu ~]# <span class="built_in">cat</span> /data/dir1/fstab</span><br><span class="line"><span class="comment"># /etc/fstab: static file system information.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line"><span class="comment">#不可写</span></span><br><span class="line">[root@ubuntu ~]# <span class="built_in">echo</span> <span class="string">&quot;123&quot;</span> &gt;&gt; /data/dir1/fstab</span><br><span class="line">-bash: /data/dir1/fstab: Read-only file system</span><br><span class="line"></span><br><span class="line">[root@ubuntu ~]# <span class="built_in">touch</span> /data/dir1/test</span><br><span class="line"><span class="built_in">touch</span>: cannot <span class="built_in">touch</span> <span class="string">&#x27;/data/dir1/test&#x27;</span>: Read-only file system</span><br></pre></td></tr></table></figure>

<p>范例：指定客户端主机</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">[root@ubuntu ~]# <span class="built_in">cat</span> /etc/exports</span><br><span class="line"><span class="comment">#10.0.0.206 可读写， 10.0.0.150 默认选项</span></span><br><span class="line">/data/dira  10.0.0.206(rw)  10.0.0.150</span><br><span class="line"></span><br><span class="line"><span class="comment">#生效</span></span><br><span class="line">[root@ubuntu ~]# exportfs -r</span><br><span class="line">[root@ubuntu ~]# exportfs -v</span><br><span class="line">/data/dira 10.0.0.206(<span class="built_in">sync</span>,wdelay,hide,no_subtree_check,sec=sys,rw,secure,root_squash,no_all_squash)</span><br><span class="line">/data/dira 10.0.0.150(<span class="built_in">sync</span>,wdelay,hide,no_subtree_check,sec=sys,ro,secure,root_squash,no_all_squash)</span><br><span class="line"></span><br><span class="line"><span class="comment">#206 主机上测试，还是可读不可写</span></span><br><span class="line">[root@ubuntu ~]# <span class="built_in">ls</span> -l /data/dir1/</span><br><span class="line">total 4</span><br><span class="line">-rw-r--r-- 1 root root 657 Jul  9 09:58 fstab</span><br><span class="line"></span><br><span class="line">[root@ubuntu ~]# <span class="built_in">cat</span> /data/dir1/fstab</span><br><span class="line"><span class="comment"># /etc/fstab: static file system information.</span></span><br><span class="line"></span><br><span class="line">[root@ubuntu ~]# <span class="built_in">touch</span> /data/dir1/test-206</span><br><span class="line"><span class="built_in">touch</span>: cannot <span class="built_in">touch</span> <span class="string">&#x27;/data/dir1/test-206&#x27;</span>: Permission denied	<span class="comment">#权限不够</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看服务器上共享目录的权限</span></span><br><span class="line">[root@ubuntu ~]# ll /data/dira/</span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x 1 root root 657 Jul  9 09:58 /data/dira</span><br><span class="line"><span class="comment">#虽然root上w权限，但是仅限于服务器的root，206虽然是以root用户远程连接，但是属于其他</span></span><br><span class="line"></span><br><span class="line">[root@ubuntu ~]#<span class="built_in">chmod</span> 777 /data/dira</span><br><span class="line"><span class="comment">#成功</span></span><br><span class="line">[root@ubuntu ~]# <span class="built_in">touch</span> /data/dir1/test-206</span><br><span class="line"></span><br><span class="line"><span class="comment">#客户端去服务器访问数据的时候，如果是以root身份，将映射成服务器的nobody用户，所以解释了为什么206虽然是以root用户远程连接，但是属于其他用户，之前无权限创建时因为没有给nobody用户授权</span></span><br><span class="line">[root@ubuntu ~]# ll /data/dir1/</span><br><span class="line">total 4</span><br><span class="line">-rw-r--r-- 1 root   root    657 Jul  9 09:58 fstab</span><br><span class="line">-rw-r--r-- 1 nobody nogroup   0 Jul  9 10:02 test-206</span><br><span class="line"></span><br><span class="line"><span class="comment">#所以解决权限问题有三种办法</span></span><br><span class="line"><span class="comment">#第一种</span></span><br><span class="line">[root@ubuntu ~]#<span class="built_in">chown</span> nobody /data/dira/</span><br><span class="line"><span class="comment">#第二种</span></span><br><span class="line">[root@ubuntu ~]#setfacl -m u:nobody:rwx /data/dira/</span><br><span class="line"><span class="comment">#第三种</span></span><br><span class="line">[root@ubuntu ~]# <span class="built_in">cat</span> /etc/exports</span><br><span class="line">/data/dira  10.0.0.206(rw,no_root_squash)  10.0.0.150</span><br><span class="line"></span><br><span class="line"><span class="comment">#150 主机上测试</span></span><br><span class="line">[root@rocky ~]# <span class="built_in">mkdir</span> /data/dir&#123;1,2&#125;</span><br><span class="line">[root@rocky ~]# showmount -e 10.0.0.208</span><br><span class="line">Export list <span class="keyword">for</span> 10.0.0.208:</span><br><span class="line">/data/dira 10.0.0.150,10.0.0.206</span><br><span class="line"></span><br><span class="line"><span class="comment">#挂载</span></span><br><span class="line">[root@rocky ~]# mount 10.0.0.208:/data/dira /data/dir1</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看</span></span><br><span class="line">[root@rocky ~]# <span class="built_in">df</span> /data/dir1/</span><br><span class="line">Filesystem      1K-blocks  Used Available Use% Mounted on</span><br><span class="line">10.0.0.208:/data/dira 101590016 7749888  88633344  9% /data/dir1</span><br><span class="line"></span><br><span class="line">[root@rocky ~]# mount</span><br><span class="line">10.0.0.208:/data/dira on /data/dir1 <span class="built_in">type</span> nfs4</span><br><span class="line">(rw,relatime,vers=4.2,rsize=262144,wsize=262144,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,clientaddr=10.0.0.150,local_lock=none,addr=10.0.0.208)</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看，可读不可写</span></span><br><span class="line">[root@rocky ~]# <span class="built_in">ls</span> -l /data/dir1</span><br><span class="line">total 4</span><br><span class="line">-rw-r--r-- 1 root root 657 Jul  9 09:58 fstab</span><br><span class="line"></span><br><span class="line">[root@rocky ~]# <span class="built_in">cat</span> /data/dir1/fstab</span><br><span class="line"><span class="comment"># /etc/fstab: static file system information.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[root@rocky ~]# <span class="built_in">touch</span> /data/dir1/test-150</span><br><span class="line"><span class="built_in">touch</span>: cannot <span class="built_in">touch</span> <span class="string">&#x27;/data/dir1/test-150&#x27;</span>: Read-only file system	</span><br></pre></td></tr></table></figure>

<p>范例：没有权限的主机无法挂载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#10.0.0.210 主机</span></span><br><span class="line">[root@ubuntu ~]# showmount -e 10.0.0.208</span><br><span class="line">Export list <span class="keyword">for</span> 10.0.0.208:</span><br><span class="line">/data/dira 10.0.0.150,10.0.0.206</span><br><span class="line"></span><br><span class="line"><span class="comment">#当前主机不在NFS 服务器配置的客户端主机列表中，无法挂载</span></span><br><span class="line">[root@ubuntu ~]# mount 10.0.0.208:/data/dira /data/dir1</span><br><span class="line">mount.nfs: access denied by server <span class="keyword">while</span> mounting 10.0.0.208:/data/dira</span><br></pre></td></tr></table></figure>

<p>范例：永久挂载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在客户端主机添加如下配置</span></span><br><span class="line">[root@ubuntu ~]# <span class="built_in">cat</span> /etc/fstab</span><br><span class="line">10.0.0.208:/data/dira /var/www/html nfs  defaults,_netdev   0  0</span><br></pre></td></tr></table></figure>

<h1 id="4-NFS工具"><a href="#4-NFS工具" class="headerlink" title="4 NFS工具"></a>4 NFS工具</h1><h2 id="4-1-rpcinfo"><a href="#4-1-rpcinfo" class="headerlink" title="4.1 rpcinfo"></a>4.1 rpcinfo</h2><p>rpcinfo 可以访问指定的 RPC 服务器，显示其响应信息，从而查询出在该服务器上注册的RPC服务，如果不指定主机，则默认是当前主机</p>
<p>查看注册在指定主机的RPC程序</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpcinfo -p hostname</span><br><span class="line">rpcinfo -s hostname</span><br></pre></td></tr></table></figure>

<p>范例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#显示已注册到本机的所有RPC服务</span></span><br><span class="line">[root@ubuntu ~]# rpcinfo</span><br><span class="line"></span><br><span class="line"><span class="comment">#显示已注册到本机的rpcbind V2 版本的 RPC 服务</span></span><br><span class="line">[root@ubuntu ~]# rpcinfo -p</span><br><span class="line"> program vers proto  port  service</span><br><span class="line">  100000   4  tcp   111 portmapper</span><br><span class="line">  100000   3  tcp   111 portmapper</span><br><span class="line">  100000   2  tcp   111 portmapper</span><br><span class="line">  </span><br><span class="line"><span class="comment">#简短格式显示</span></span><br><span class="line">[root@ubuntu ~]# rpcinfo -s</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看远程主机</span></span><br><span class="line">[root@ubuntu ~]# rpcinfo -s 10.0.0.208</span><br></pre></td></tr></table></figure>

<h2 id="4-2-exportfs"><a href="#4-2-exportfs" class="headerlink" title="4.2 exportfs"></a>4.2 exportfs</h2><p>exportfs 命令用于管理本机 NFS 文件系统，默认配置文件是 <code>/etc/exports</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-v  <span class="comment">#查看本机所有NFS共享</span></span><br><span class="line">-r  <span class="comment">#重读配置文件，并共享目录</span></span><br><span class="line">-a  <span class="comment">#输出本机所有共享</span></span><br><span class="line">-au <span class="comment">#停止本机所有共享</span></span><br></pre></td></tr></table></figure>

<h2 id="4-3-showmount"><a href="#4-3-showmount" class="headerlink" title="4.3 showmount"></a>4.3 showmount</h2><p>shoumount 可以查看远程主机的共享设置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">showmount [ -opt... ] [ host ]</span><br><span class="line"></span><br><span class="line"><span class="comment">#常用选项</span></span><br><span class="line">-h|--<span class="built_in">help</span> <span class="comment">#显示帮助</span></span><br><span class="line">-a|--all <span class="comment">#显示己连接的客户端</span></span><br><span class="line">-e|--exports <span class="comment">#显示指定NFS服务器上的配置列表</span></span><br></pre></td></tr></table></figure>

<p>范例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看远程主机的NFS共享配置</span></span><br><span class="line">[root@centos7 ~]#showmount -e 10.0.0.8</span><br><span class="line">Export list <span class="keyword">for</span> 10.0.0.8:</span><br><span class="line">/data/wordpress *</span><br></pre></td></tr></table></figure>

<h2 id="4-4-mount-nfs"><a href="#4-4-mount-nfs" class="headerlink" title="4.4 mount.nfs"></a>4.4 mount.nfs</h2><p>客户端 NFS 服务挂载命令，将远程NFS服务器上共享出来的目录挂载到本机，可以直接写成 mount</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mount [选项] &lt;远程主机:导出路径&gt; &lt;本地挂载点&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">#常用选项</span></span><br><span class="line">-r 	<span class="comment">#只读挂载</span></span><br><span class="line">-v 	<span class="comment">#显示详细信息</span></span><br><span class="line">-V 	<span class="comment">#显示版本</span></span><br><span class="line">-w 	<span class="comment">#读写挂载</span></span><br><span class="line">-n 	<span class="comment">#不更新/etc/fstab 文件，默认项</span></span><br><span class="line"></span><br><span class="line">-o 	<span class="comment">#指定挂载参数，更多挂载选项：man 5 nfs</span></span><br><span class="line">	<span class="built_in">fg</span> 						<span class="comment">#（默认）前台挂载</span></span><br><span class="line">	<span class="built_in">bg</span> 						<span class="comment">#后台挂载</span></span><br><span class="line">	hard 					<span class="comment">#（默认）持续请求，如果挂不上，一直重试</span></span><br><span class="line">	soft   				<span class="comment">#非持续请求</span></span><br><span class="line">	intr   				<span class="comment">#是否可以强制中断，配合hard 选项，如果挂不上，可以ctrl+c 中断</span></span><br><span class="line">	rsize/wsize 	<span class="comment">#指定一次读/写的最大字节数，值必须为1024的倍数，最大为1048576，最小为1024，如果小于1024会被替换成4096</span></span><br><span class="line">	nosuid     		<span class="comment">#挂载的文件系统中，setuid 和 setgid 位将被忽略。用于安全目的，防止执行带有特权的程序。</span></span><br><span class="line">  noexec     		<span class="comment">#禁止在挂载的文件系统上直接执行任何二进制程序。常用于提高安全性，如挂载用户上传目录。</span></span><br><span class="line">	_netdev 			<span class="comment">#无网络服务时不挂载NFS资源</span></span><br><span class="line">	vers   				<span class="comment">#指定版本，客户端centos8默认4.2 ，centos7默认4.1 centos6默认4.0，如果NFS 服务端不支持此版本，则无法挂载</span></span><br><span class="line">	</span><br><span class="line">提示：基于安全考虑，建议使用 nosuid , _netdev , noexec 挂载选项</span><br></pre></td></tr></table></figure>

<p>范例：临时挂载NFS共享</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@ubuntu ~]# mount -o rw,<span class="built_in">fg</span>,hard,intr 10.0.0.208:/testdir /mnt/nfs/</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 ~]#<span class="built_in">mkdir</span> /mnt/nfs</span><br><span class="line">[root@centos7 ~]#mount 10.0.0.8:/data/wordpress /mnt/nfs</span><br><span class="line">[root@centos7 ~]#<span class="built_in">ls</span> /mnt/nfs</span><br><span class="line">index.html</span><br><span class="line"></span><br><span class="line">[root@centos7 ~]#<span class="built_in">df</span> -T /mnt/nfs</span><br><span class="line">Filesystem               Type  1K-blocks  Used    Available Use%  Mounted on</span><br><span class="line">10.0.0.8:/data/wordpress nfs4  52403200   398336  52004864  1%    /mnt/nfs</span><br></pre></td></tr></table></figure>

<p>范例：开机挂载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#vim /etc/fstab </span></span><br><span class="line">172.16.0.1:/public  /mnt/nfs  nfs  defaults,_netdev  0  0</span><br></pre></td></tr></table></figure>

<p>远程的 root 映射为NFS服务器的nobody用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@centos6 ~]#grep nobody /etc/passwd</span><br><span class="line">nobody:x:99:99:Nobody:/:/sbin/nologin</span><br><span class="line">nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin</span><br><span class="line"></span><br><span class="line">[root@centos7 ~]#grep nobody /etc/passwd</span><br><span class="line">nobody:x:99:99:Nobody:/:/sbin/nologin</span><br><span class="line">nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin</span><br><span class="line"></span><br><span class="line">[root@centos8 ~]#grep nobody /etc/passwd</span><br><span class="line">nobody:x:65534:65534:Kernel Overflow User:/:/sbin/nologin</span><br></pre></td></tr></table></figure>

<h1 id="5-NFS共享实现"><a href="#5-NFS共享实现" class="headerlink" title="5 NFS共享实现"></a>5 NFS共享实现</h1><h2 id="5-1-目标"><a href="#5-1-目标" class="headerlink" title="5.1 目标"></a>5.1 目标</h2><p>将NFS的共享目录，做为远程主机用户的家目录</p>
<h2 id="5-2-环境准备"><a href="#5-2-环境准备" class="headerlink" title="5.2 环境准备"></a>5.2 环境准备</h2><p><img src="/Storage/nfs/1753757619122-10db5517-4fdc-4dfc-af51-1165c40e44f6-175568388467411.png" alt="null"></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">共三台主机</span><br><span class="line">一台主机 nfs server</span><br><span class="line">IP:10.0.0.8</span><br><span class="line">另两台当 nfs client</span><br><span class="line">IP:10.0.0.7</span><br><span class="line">IP:10.0.0.6</span><br></pre></td></tr></table></figure>

<h2 id="5-3-步骤"><a href="#5-3-步骤" class="headerlink" title="5.3 步骤"></a>5.3 步骤</h2><h3 id="5-3-1-在服务端配置共享"><a href="#5-3-1-在服务端配置共享" class="headerlink" title="5.3.1 在服务端配置共享"></a>5.3.1 在服务端配置共享</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#NFS服务器创建用户和相应的家目录，将用户wang的家目录共享</span></span><br><span class="line">[root@centos8 ~]#yum -y install nfs-utils</span><br><span class="line">[root@centos8 ~]#systemctl <span class="built_in">enable</span> --now nfs-server</span><br><span class="line">[root@centos8 ~]#<span class="built_in">mkdir</span> -pv /data/home/wang</span><br><span class="line">[root@centos8 ~]#Vim /etc/exports.d/test.exports</span><br><span class="line">/data/home/wang *(rw)</span><br><span class="line">[root@centos8 ~]#exportfs -r</span><br></pre></td></tr></table></figure>

<h3 id="5-3-2-客户端配置"><a href="#5-3-2-客户端配置" class="headerlink" title="5.3.2 客户端配置"></a>5.3.2 客户端配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在第一台NFS客户端主机10.0.0.7上实现</span></span><br><span class="line">[root@centos7 ~]#yum -y install nfs-utils</span><br><span class="line">[root@centos7 ~]#useradd -u 2000 wang</span><br><span class="line">[root@centos7 ~]#vim /etc/fstab</span><br><span class="line">10.0.0.8:/data/home/wang /home/wang  nfs _netdev 0 0</span><br><span class="line"></span><br><span class="line">[root@centos7 ~]#mount -a</span><br><span class="line">[root@centos7 ~]#su - wang</span><br><span class="line">Last login: Fri Jul  3 16:33:34 CST 2020 on pts/0</span><br><span class="line"></span><br><span class="line">[wang@centos7 ~]<span class="variable">$pwd</span></span><br><span class="line">/home/wang</span><br><span class="line"></span><br><span class="line">[wang@centos7 ~]<span class="variable">$df</span> /home/wang -T</span><br><span class="line">Filesystem               Type 1K-blocks  Used Available Use% Mounted on</span><br><span class="line">10.0.0.8:/data/home/wang nfs4  52403200 398464  52004736  1% /home/wang</span><br><span class="line"></span><br><span class="line"><span class="comment">#在第二台NFS客户端主机10.0.0.6上实现</span></span><br><span class="line">[root@centos6 ~]#yum -y install nfs-utils</span><br><span class="line">[root@centos6 ~]#useradd -u 2000 wang</span><br><span class="line">[root@centos6 ~]#vim /etc/fstab</span><br><span class="line">10.0.0.8:/data/home/wang /home/wang  nfs _netdev 0 0</span><br><span class="line"></span><br><span class="line">[root@centos6 ~]#su - wang</span><br><span class="line">[wang@centos6 ~]<span class="variable">$pwd</span></span><br><span class="line">/home/wang</span><br><span class="line"></span><br><span class="line">[wang@centos6 ~]<span class="variable">$df</span> -T /home/wang</span><br><span class="line">Filesystem               Type 1K-blocks  Used Available Use% Mounted on</span><br><span class="line">10.0.0.8:/data/home/wang nfs  52403200 398464  52004736  1% /home/wang</span><br></pre></td></tr></table></figure>

<h3 id="5-3-3-用户映射"><a href="#5-3-3-用户映射" class="headerlink" title="5.3.3 用户映射"></a>5.3.3 用户映射</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#普通用户不映射</span></span><br><span class="line"><span class="comment">#在客户机上以普通用户创建文件</span></span><br><span class="line">[wang@centos7 ~]$ <span class="built_in">touch</span> /home/wang/wang.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">#客户机上显示属主属组是wang</span></span><br><span class="line">[wang@centos7 ~]$ <span class="built_in">ls</span> -l /home/wang/wang.txt</span><br><span class="line">-rw-rw-r-- 1 wang wang 0 Jul  9 00:31 /home/wang/wang.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">#NFS 服务器上查看，找不到对应的用户，直接显示UID</span></span><br><span class="line">[root@centos8 ~]#<span class="built_in">ls</span> -l /data/home/wang/wang.txt</span><br><span class="line">-rw-rw-r-- 1 2000 2000 0 Jul  9 00:31 /data/home/wang/wang.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">#NFS 服务器上以相同UID 创建用户,再查看</span></span><br><span class="line">[root@centos8 ~]#useradd -d /data/home/wang -u 2000 wang</span><br><span class="line">[root@centos8 ~]#<span class="built_in">ls</span> -l /data/home/wang/wang.txt</span><br><span class="line">-rw-rw-r-- 1 wang wang 0 Jul  9 00:31 /data/home/wang/wang.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">#再次修改规则，all_squash 项会覆盖 no_root_squash</span></span><br><span class="line">[root@centos8 ~]#<span class="built_in">cat</span> /etc/exports</span><br><span class="line">/data/www *(rw,no_root_squash,all_squash)</span><br><span class="line"></span><br><span class="line"><span class="comment">#生效</span></span><br><span class="line">[root@centos8 ~]# exportfs -r</span><br><span class="line">[root@centos8 ~]# exportfs -v</span><br><span class="line">/data/www   &lt;world&gt;</span><br><span class="line">(<span class="built_in">sync</span>,wdelay,hide,no_subtree_check,sec=sys,rw,secure,no_root_squash,all_squash)</span><br><span class="line"></span><br><span class="line"><span class="comment">#在客户端创建文件</span></span><br><span class="line">[root@centos7 ~]#<span class="built_in">touch</span> /home/wang/wang1.txt</span><br><span class="line">[root@centos7 ~]#su - wang </span><br><span class="line">[wang@centos7 ~]$ <span class="built_in">touch</span> /home/wang/wang2.txt</span><br><span class="line">[wang@centos7 ~]$ <span class="built_in">exit</span></span><br><span class="line"><span class="built_in">logout</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#在客户端查看</span></span><br><span class="line">[root@centos7 ~]# ll /home/wang/wang&#123;1,2&#125;.txt</span><br><span class="line">-rw-r--r-- 1 nobody nogroup 0 Jul  9 08:51 /home/wang/wang2.txt</span><br><span class="line">-rw-rw-r-- 1 nobody nogroup 0 Jul  9 08:51 /home/wang/wang1.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">#在NFS服务端查看，普通用户和 root 都被映射</span></span><br><span class="line">[root@centos8 ~]# ll /data/home/wang/wang&#123;1,2&#125;.txt</span><br><span class="line">-rw-r--r-- 1 nobody nogroup 0 Jul  9 08:51 /data/home/wang/wang2.txt</span><br><span class="line">-rw-rw-r-- 1 nobody nogroup 0 Jul  9 08:51 /data/home/wang/wang1.txt</span><br></pre></td></tr></table></figure>

<h3 id="5-3-4-统一用户映射"><a href="#5-3-4-统一用户映射" class="headerlink" title="5.3.4 统一用户映射"></a>5.3.4 统一用户映射</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#NFS 服务端配置</span></span><br><span class="line">[root@centos8 ~]# groupadd -g 12345 www</span><br><span class="line">[root@centos8 ~]# useradd -u 12345 -g 12345 -s /sbin/nologin www</span><br><span class="line"></span><br><span class="line"><span class="comment">#指定映射用户，对 root 和普通用户都生效</span></span><br><span class="line">[root@centos7 ~]# <span class="built_in">cat</span> /etc/exports</span><br><span class="line">/data/www *(rw,all_squash,anongid=12345,anonuid=12345)</span><br><span class="line"></span><br><span class="line">[root@ubuntu ~]# exportfs -r</span><br><span class="line">[root@ubuntu ~]# exportfs -v</span><br><span class="line">/data/www   &lt;world&gt;</span><br><span class="line">(<span class="built_in">sync</span>,wdelay,hide,no_subtree_check,anonuid=12345,anongid=12345	,sec=sys,rw,secure,root_squash,all_squash)</span><br><span class="line"></span><br><span class="line"><span class="comment">#客户端创建文件</span></span><br><span class="line">[root@centos7 ~]# <span class="built_in">touch</span> /home/wang/wang3.txt</span><br><span class="line">[root@centos7 ~]# su - wang</span><br><span class="line">[wang@centos7 ~]$ <span class="built_in">touch</span> /home/wang/wang4.txt</span><br><span class="line">[wang@centos7 ~]$ <span class="built_in">exit</span></span><br><span class="line"><span class="built_in">logout</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#客户端查看</span></span><br><span class="line">[root@centos7 ~]# ll /home/wang/wang&#123;3,4&#125;.txt</span><br><span class="line">-rw-r--r-- 1 12345 12345 0 Jul  9 09:37 /home/wang/wang4.txt</span><br><span class="line">-rw-rw-r-- 1 12345 12345 0 Jul  9 09:37 /home/wang/wang3.txt</span><br></pre></td></tr></table></figure>

<p><strong>统一客户端主机用户和权限的方法</strong></p>
<ol>
<li><p>保证客户端主机使用相同的用户(相同的用户ID)对共享目录进行读写</p>
</li>
<li><p>在NFS 服务器上统一映射</p>
</li>
<li><p>新建服务器使用 LDAP（轻量级目录访问协议） 服务进行集中的帐号管理</p>
</li>
</ol>
<p><img src="/Storage/nfs/1753757619201-920adb99-6634-4d4a-8286-b1244f09d801-17556838846744.png" alt="null"></p>
<h1 id="6-基于LAMP架构，通过NFS实现数据共享存储，并实时同步到备份服务器"><a href="#6-基于LAMP架构，通过NFS实现数据共享存储，并实时同步到备份服务器" class="headerlink" title="6 基于LAMP架构，通过NFS实现数据共享存储，并实时同步到备份服务器"></a>6 基于LAMP架构，通过NFS实现数据共享存储，并实时同步到备份服务器</h1><p>储备知识：<a href="https://aquapluto.github.io/Linux/service-manage/data-synchronization/">数据实时同步</a></p>
<p><img src="/Storage/nfs/1753757619488-6a4e9c59-197f-42e8-ab7a-9dea2cd4a17b-17556838846749.png" alt="null"></p>
<p>架构说明：两台web服务器（WordPress），将业务数据（如 WordPress 的文章、用户信息等）存储在mysql，静态文件资源存储在NFS上，两台web服务器共享，保证多 Web 节点的内容同步，并实时同步到备份服务器上</p>
<table>
<thead>
<tr>
<th>配置</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>10.0.0.176（centos）</td>
<td>DNS</td>
</tr>
<tr>
<td>10.0.0.177</td>
<td>MySQL</td>
</tr>
<tr>
<td>10.0.0.179（rocky）</td>
<td>Web</td>
</tr>
<tr>
<td>10.0.0.180</td>
<td>Web</td>
</tr>
<tr>
<td>10.0.0.182（Ubuntu）</td>
<td>NFS</td>
</tr>
<tr>
<td>10.0.0.183</td>
<td>NFS BACKUP</td>
</tr>
</tbody></table>
<h2 id="6-1-配置DNS"><a href="#6-1-配置DNS" class="headerlink" title="6.1 配置DNS"></a>6.1 配置DNS</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">[root@DNS ~]#yum -y install <span class="built_in">bind</span> bind-utils</span><br><span class="line">[root@DNS ~]#systemctl <span class="built_in">enable</span> --now named</span><br><span class="line">[root@DNS ~]#vim /etc/named.rfc1912.zones</span><br><span class="line">zone <span class="string">&quot;wu.org&quot;</span> IN &#123;</span><br><span class="line">    <span class="built_in">type</span> master;</span><br><span class="line">    file <span class="string">&quot;wu.org.zone&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@DNS ~]#vim /etc/named.conf      </span><br><span class="line">// listen-on port 53 &#123; 127.0.0.1; &#125;;</span><br><span class="line">// allow-query   &#123; localhost; &#125;;</span><br><span class="line"></span><br><span class="line">[root@DNS ~]#vim /var/named/wu.org.zone</span><br><span class="line"><span class="variable">$TTL</span> 1D</span><br><span class="line">@   IN  SOA     wu.org. admin.wu.com. (1 3H 1M 1D 1W)</span><br><span class="line">        NS      master    </span><br><span class="line">master  A       10.0.0.176</span><br><span class="line">www     A       10.0.0.179</span><br><span class="line">www     A       10.0.0.180</span><br><span class="line"></span><br><span class="line">[root@DNS ~]#<span class="built_in">chmod</span> 640 /var/named/wu.org.zone </span><br><span class="line">[root@DNS ~]#<span class="built_in">chgrp</span> named /var/named/wu.org.zone</span><br><span class="line">[root@DNS ~]#named-checkconf</span><br><span class="line">[root@DNS ~]#named-checkzone wu.org /var/named/wu.org.zone</span><br><span class="line">[root@DNS ~]#rndc reload</span><br><span class="line"></span><br><span class="line"><span class="comment">#测试</span></span><br><span class="line">[root@DNS ~]#host www.wu.org 127.0.0.1</span><br><span class="line">Using domain server:</span><br><span class="line">Name: 127.0.0.1</span><br><span class="line">Address: 127.0.0.1#53</span><br><span class="line">Aliases: </span><br><span class="line"></span><br><span class="line">www.wu.org has address 10.0.0.179</span><br><span class="line">www.wu.org has address 10.0.0.180</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;nslookup</span><br><span class="line"></span><br><span class="line">&gt; server 10.0.0.176</span><br><span class="line">默认服务器:  [10.0.0.176]</span><br><span class="line">Address:  10.0.0.176</span><br><span class="line"></span><br><span class="line">&gt; www.wu.org</span><br><span class="line">服务器:  [10.0.0.176]</span><br><span class="line">Address:  10.0.0.176</span><br><span class="line"></span><br><span class="line">名称:    www.wu.org</span><br><span class="line">Addresses:  10.0.0.180</span><br><span class="line">          10.0.0.179</span><br><span class="line">          </span><br><span class="line"><span class="comment">#Switchhosts软件</span></span><br><span class="line">10.0.0.179 www.wu.org</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;ping www.wu.org</span><br><span class="line">正在 Ping www.wu.org [10.0.0.179] 具有 32 字节的数据:</span><br><span class="line">来自 10.0.0.179 的回复: 字节=32 时间&lt;1ms TTL=64</span><br><span class="line">来自 10.0.0.179 的回复: 字节=32 时间&lt;1ms TTL=64</span><br></pre></td></tr></table></figure>

<h2 id="6-2-配置Web1和MySQL"><a href="#6-2-配置Web1和MySQL" class="headerlink" title="6.2 配置Web1和MySQL"></a>6.2 配置Web1和MySQL</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@Web1 ~]#yum -y install httpd php php-mysqlnd php-json nfs-utils</span><br><span class="line">[root@Web1 ~]#systemctl <span class="built_in">enable</span> --now httpd</span><br><span class="line">[root@Web1 ~]#wget https://cn.wordpress.org/latest-zh_CN.zip</span><br><span class="line">[root@Web1 ~]#unzip latest-zh_CN.zip</span><br><span class="line">[root@Web1 ~]#<span class="built_in">mv</span> wordpress/* /var/www/html/</span><br><span class="line">[root@Web1 ~]#<span class="built_in">chown</span> apache.apache /var/www/html/ -R</span><br><span class="line"></span><br><span class="line">[root@MySQL ~]#yum install -y mysql-server</span><br><span class="line">[root@MySQL ~]#systemctl <span class="built_in">enable</span> --now mysqld</span><br><span class="line"><span class="comment">#Ubuntu默认开启mysql，但是要改端口指向地址</span></span><br><span class="line">vim /etc/mysql/mysql.conf.d/mysqld.cnf</span><br><span class="line"><span class="comment">#bind...</span></span><br><span class="line"><span class="comment">#mysql...</span></span><br><span class="line">systemctl restart mysql</span><br><span class="line"></span><br><span class="line">mysql&gt; create database wordpress;</span><br><span class="line">mysql&gt; create user wordpress@<span class="string">&#x27;10.0.0.%&#x27;</span> identified by <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line">mysql&gt; grant all on wordpress.* to wordpress@<span class="string">&#x27;10.0.0.%&#x27;</span>;</span><br><span class="line"></span><br><span class="line">Windows访问：www.wu.org</span><br><span class="line"></span><br><span class="line">[root@Web1 ~]#<span class="built_in">cd</span> /var/www/html/wp-content/</span><br><span class="line">[root@Web1 wp-content]#<span class="built_in">ls</span></span><br><span class="line">index.php  languages  plugins  themes  uploads</span><br><span class="line"><span class="comment">#说明</span></span><br><span class="line">themes:主题</span><br><span class="line">uploads：图片</span><br></pre></td></tr></table></figure>

<h2 id="6-3-配置NFS"><a href="#6-3-配置NFS" class="headerlink" title="6.3 配置NFS"></a>6.3 配置NFS</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[root@NFS ~]#apt update &amp;&amp; apt install -y nfs-server</span><br><span class="line">[root@NFS ~]#<span class="built_in">mkdir</span> -p /data/www</span><br><span class="line">[root@NFS ~]#<span class="built_in">mkdir</span> /etc/exports.d</span><br><span class="line"></span><br><span class="line">[root@NFS ~]#vim /etc/exports.d/wordpress.exports</span><br><span class="line">/data/www 10.0.0.0/24(rw)</span><br><span class="line"></span><br><span class="line">[root@NFS ~]#exportfs -r</span><br><span class="line"></span><br><span class="line">[root@NFS ~]#groupadd -g 48 apache</span><br><span class="line">[root@NFS ~]#useradd -u 48 -g 48 apache</span><br><span class="line">[root@NFS ~]#<span class="built_in">chown</span> -R apache.apache /data/www/</span><br><span class="line"><span class="comment">#说明</span></span><br><span class="line">如果web服务器为Ubuntu，就只需执行<span class="built_in">chown</span> -R www-data.www-data /data/www/，因为Ubuntu共有www-data账号</span><br><span class="line"></span><br><span class="line">[root@Web1 ~]#rsync -av /var/www/html/ 10.0.0.182:/data/www/</span><br><span class="line">[root@NFS ~]#ll /data/www/</span><br><span class="line">total 244</span><br><span class="line">drwxr-xr-x  5 apache apache  4096 Dec 13 06:23 ./</span><br><span class="line">drwxr-xr-x  3 root   root    4096 Dec 13 06:50 ../</span><br><span class="line">-rw-r--r--  1 apache apache   228 Dec 13 06:23 .htaccess</span><br><span class="line">-rw-r--r--  1 apache apache   405 Feb  6  2020 index.php</span><br><span class="line">-rw-r--r--  1 apache apache 19915 Dec  6 18:09 license.txt</span><br><span class="line">-rw-r--r--  1 apache apache  7399 Dec  6 18:09 readme.html</span><br><span class="line">-rw-r--r--  1 apache apache  7211 May 12  2023 wp-activate.php</span><br><span class="line">drwxr-xr-x  9 apache apache  4096 Dec  6 18:00 wp-admin/</span><br><span class="line">-rw-r--r--  1 apache apache   351 Feb  6  2020 wp-blog-header.php</span><br><span class="line">-rw-r--r--  1 apache apache  2323 Jun 14 14:11 wp-comments-post.php</span><br><span class="line">-rw-rw-rw-  1 apache apache  3293 Dec 13 06:09 wp-config.php</span><br><span class="line">-rw-r--r--  1 apache apache  3013 Dec  6 18:09 wp-config-sample.php</span><br><span class="line">drwxr-xr-x  6 apache apache  4096 Dec 13 06:28 wp-content/</span><br><span class="line">-rw-r--r--  1 apache apache  5638 May 30  2023 wp-cron.php</span><br><span class="line">drwxr-xr-x 27 apache apache 12288 Dec  6 18:09 wp-includes/</span><br><span class="line">-rw-r--r--  1 apache apache  2502 Nov 26  2022 wp-links-opml.php</span><br><span class="line">-rw-r--r--  1 apache apache  3927 Jul 16 12:16 wp-load.php</span><br><span class="line">-rw-r--r--  1 apache apache 50924 Sep 29 22:01 wp-login.php</span><br><span class="line">-rw-r--r--  1 apache apache  8525 Sep 16 06:50 wp-mail.php</span><br><span class="line">-rw-r--r--  1 apache apache 26409 Oct 10 14:05 wp-settings.php</span><br><span class="line">-rw-r--r--  1 apache apache 34385 Jun 19 18:27 wp-signup.php</span><br><span class="line">-rw-r--r--  1 apache apache  4885 Jun 22 14:36 wp-trackback.php</span><br><span class="line">-rw-r--r--  1 apache apache  3154 Sep 30 07:39 xmlrpc.php</span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@Web1 ~]#showmount -e 10.0.0.182</span><br><span class="line">Export list <span class="keyword">for</span> 10.0.0.182:</span><br><span class="line">/data/www 10.0.0.0/24</span><br><span class="line"></span><br><span class="line">[root@Web1 ~]#<span class="built_in">mv</span> /var/www/html/* /opt/</span><br><span class="line">[root@Web1 ~]#vim /etc/fstab </span><br><span class="line">10.0.0.182:/data/www /var/www/html nfs _netdev 0 0 </span><br><span class="line"></span><br><span class="line">[root@Web1 ~]#mount -a</span><br><span class="line">[root@Web1 ~]#<span class="built_in">df</span></span><br><span class="line">Filesystem           1K-blocks    Used Available Use% Mounted on</span><br><span class="line">devtmpfs                894016       0    894016   0% /dev</span><br><span class="line">tmpfs                   914116       0    914116   0% /dev/shm</span><br><span class="line">tmpfs                   914116    8936    905180   1% /run</span><br><span class="line">tmpfs                   914116       0    914116   0% /sys/fs/cgroup</span><br><span class="line">/dev/mapper/rl-root   17811456 2600584  15210872  15% /</span><br><span class="line">/dev/sda1              1038336  217304    821032  21% /boot</span><br><span class="line">tmpfs                   182820       0    182820   0% /run/user/0</span><br><span class="line">10.0.0.182:/data/www  10219008 3314688   6363648  35% /var/www/html</span><br><span class="line"></span><br><span class="line">[root@Web1 ~]#<span class="built_in">ls</span> /var/www/html/</span><br><span class="line">index.php        wp-admin              wp-config-sample.php  wp-links-opml.php  wp-settings.php</span><br><span class="line">license.txt      wp-blog-header.php    wp-content            wp-load.php        wp-signup.php</span><br><span class="line">readme.html      wp-comments-post.php  wp-cron.php           wp-login.php       wp-trackback.php</span><br><span class="line">wp-activate.php  wp-config.php         wp-includes           wp-mail.php        xmlrpc.php</span><br><span class="line"></span><br><span class="line"><span class="comment">#Windows访问正常</span></span><br></pre></td></tr></table></figure>

<h2 id="6-4-配置Web2"><a href="#6-4-配置Web2" class="headerlink" title="6.4 配置Web2"></a>6.4 配置Web2</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@Web2 ~]#yum -y install httpd php php-mysqlnd php-json nfs-utils</span><br><span class="line">[root@Web2 ~]#systemctl <span class="built_in">enable</span> --now httpd</span><br><span class="line">[root@Web2 ~]#vim /etc/fstab </span><br><span class="line">10.0.0.182:/data/www /var/www/html nfs _netdev 0 0 </span><br><span class="line"></span><br><span class="line">[root@Web2 ~]#mount -a</span><br><span class="line">[root@Web2 ~]#<span class="built_in">df</span></span><br><span class="line">Filesystem           1K-blocks    Used Available Use% Mounted on</span><br><span class="line">devtmpfs                894016       0    894016   0% /dev</span><br><span class="line">tmpfs                   914116       0    914116   0% /dev/shm</span><br><span class="line">tmpfs                   914116    8916    905200   1% /run</span><br><span class="line">tmpfs                   914116       0    914116   0% /sys/fs/cgroup</span><br><span class="line">/dev/mapper/rl-root   17811456 2431172  15380284  14% /</span><br><span class="line">/dev/sda1              1038336  217304    821032  21% /boot</span><br><span class="line">tmpfs                   182820       0    182820   0% /run/user/0</span><br><span class="line">10.0.0.182:/data/www  10219008 3314688   6363648  35% /var/www/html</span><br><span class="line"></span><br><span class="line">[root@Web2 ~]#<span class="built_in">ls</span> /var/www/html/</span><br><span class="line">index.php        wp-admin              wp-config-sample.php  wp-links-opml.php  wp-settings.php</span><br><span class="line">license.txt      wp-blog-header.php    wp-content            wp-load.php        wp-signup.php</span><br><span class="line">readme.html      wp-comments-post.php  wp-cron.php           wp-login.php       wp-trackback.php</span><br><span class="line">wp-activate.php  wp-config.php         wp-includes           wp-mail.php        xmlrpc.php</span><br><span class="line"></span><br><span class="line"><span class="comment">#Switchhosts软件</span></span><br><span class="line">10.0.0.180 www.wu.org</span><br></pre></td></tr></table></figure>

<h2 id="6-5-配置backup"><a href="#6-5-配置backup" class="headerlink" title="6.5 配置backup"></a>6.5 配置backup</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[root@BACKUP ~]#vim /etc/rsyncd.conf</span><br><span class="line">uid = root</span><br><span class="line">gid = root</span><br><span class="line">max connections = 0</span><br><span class="line">ignore errors</span><br><span class="line">exclude = lost+found/</span><br><span class="line"><span class="built_in">log</span> file = /var/log/rsyncd.log</span><br><span class="line">pid file = /var/run/rsyncd.pid</span><br><span class="line">lock file = /var/run/rsyncd.lock</span><br><span class="line">reverse lookup = no</span><br><span class="line"></span><br><span class="line">[backup]</span><br><span class="line">path = /data/backup/</span><br><span class="line">comment = backup <span class="built_in">dir</span></span><br><span class="line"><span class="built_in">read</span> only = no</span><br><span class="line">auth <span class="built_in">users</span> = rsyncuser</span><br><span class="line">secrets file = /etc/rsync.pas</span><br><span class="line"></span><br><span class="line">[root@BACKUP ~]#<span class="built_in">mkdir</span> -pv /data/backup</span><br><span class="line">[root@BACKUP ~]#<span class="built_in">echo</span> <span class="string">&quot;rsyncuser:123456&quot;</span> &gt; /etc/rsync.pas</span><br><span class="line">[root@BACKUP ~]#<span class="built_in">chmod</span> 600 /etc/rsync.pas</span><br><span class="line">[root@BACKUP ~]#systemctl restart rsync.service</span><br><span class="line"></span><br><span class="line">[root@NFS ~]#tar xf sersync2.5.4_64bit_binary_stable_final.tar.gz -C /usr/local/</span><br><span class="line">[root@NFS ~]#<span class="built_in">cd</span> /usr/local/</span><br><span class="line">[root@NFS <span class="built_in">local</span>]#<span class="built_in">ls</span></span><br><span class="line">bin  etc  games  GNU-Linux-x86  include  lib  man  sbin  share  src</span><br><span class="line"></span><br><span class="line">[root@NFS <span class="built_in">local</span>]#<span class="built_in">ln</span> -s GNU-Linux-x86/ sersync</span><br><span class="line">[root@NFS <span class="built_in">local</span>]#<span class="built_in">ln</span> -s /usr/local/sersync/sersync2 /usr/local/bin/</span><br><span class="line">[root@NFS <span class="built_in">local</span>]#<span class="built_in">cd</span> sersync</span><br><span class="line">[root@NFS sersync]#<span class="built_in">rm</span> -rf confxml.xml </span><br><span class="line">[root@NFS sersync]#rz</span><br><span class="line">[root@NFS sersync]#<span class="built_in">ls</span></span><br><span class="line">confxml.xml  sersync2</span><br><span class="line"></span><br><span class="line">[root@NFS sersync]#vim confxml.xml</span><br><span class="line">&lt;remote ip=<span class="string">&quot;10.0.0.183&quot;</span> name=<span class="string">&quot;backup&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">[root@NFS sersync]#<span class="built_in">echo</span> 123456 &gt; /etc/rsync.pas</span><br><span class="line">[root@NFS sersync]#<span class="built_in">chmod</span> 600 /etc/rsync.pas</span><br></pre></td></tr></table></figure>

<h2 id="6-6-测试"><a href="#6-6-测试" class="headerlink" title="6.6 测试"></a>6.6 测试</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@NFS ~]#sersync2 -dro /usr/local/sersync/confxml.xml</span><br><span class="line">后台执行：<span class="built_in">nohup</span> sersync2 -dro /usr/local/sersync/confxml.xml &amp;&gt; /dev/null &amp;</span><br><span class="line"></span><br><span class="line">[root@BACKUP ~]#<span class="built_in">ls</span> /data/backup/</span><br><span class="line">index.php        wp-admin              wp-config-sample.php  wp-links-opml.php  wp-settings.php</span><br><span class="line">license.txt      wp-blog-header.php    wp-content            wp-load.php        wp-signup.php</span><br><span class="line">readme.html      wp-comments-post.php  wp-cron.php           wp-login.php       wp-trackback.php</span><br><span class="line">wp-activate.php  wp-config.php         wp-includes           wp-mail.php        xmlrpc.php</span><br><span class="line"></span><br><span class="line">[root@BACKUP ~]#tree /data/backup/wp-content/uploads/</span><br><span class="line">/data/backup/wp-content/uploads/</span><br><span class="line">└── 2023</span><br><span class="line">    └── 12</span><br><span class="line">        └── image.png1</span><br><span class="line"></span><br><span class="line"><span class="comment">#Windows发表新的文章</span></span><br><span class="line"></span><br><span class="line">[root@BACKUP ~]#tree /data/backup/wp-content/uploads/</span><br><span class="line">/data/backup/wp-content/uploads/</span><br><span class="line">└── 2023</span><br><span class="line">    └── 12</span><br><span class="line">        └── image.png1</span><br><span class="line">        └── image.png2</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://AquaPluto.github.io">Aquarius</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://aquapluto.github.io/Storage/nfs/">https://aquapluto.github.io/Storage/nfs/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://AquaPluto.github.io" target="_blank">代码推演录</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/NFS/">NFS</a></div><div class="post-share"><div class="social-share" data-image="/img/paper2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://unpkg.com/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://unpkg.com/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/Linux/service-manage/data-synchronization/" title="数据的实时同步"><img class="cover" src="/img/paper4.png" onerror="onerror=null;src='/img/error-page.png'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">数据的实时同步</div></div><div class="info-2"><div class="info-item-1">1 数据的实时同步方式在生产环境，...</div></div></div></a><a class="pagination-related" href="/Storage/conspect/" title="存储概论"><img class="cover" src="/img/paper5.png" onerror="onerror=null;src='/img/error-page.png'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">存储概论</div></div><div class="info-2"><div class="info-item-1">1 存储类型IT 基础设施有三个主...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avator.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Aquarius</div><div class="author-info-description">分享运维开发相关技术</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">138</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" href="https://github.com/AquaPluto"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/AquaPluto" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://blog.csdn.net/m0_75233142" target="_blank" title="CSDN"><i class="fa-solid fa-code" style="color: #8a2be2;"></i></a><a class="social-icon" href="mailto:wujunlinq@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><p>持续更新文章中，有问题请添加wx</p>
<div>
  <img src="/img/wx.jpg" alt="wx" style="width: 100px">
</div>
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-NFS%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-text">1 NFS服务的工作原理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-NFS%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="toc-text">2 NFS软件包</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-NFS%E5%85%B1%E4%BA%AB%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F"><span class="toc-text">3 NFS共享配置文件格式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-NFS%E5%B7%A5%E5%85%B7"><span class="toc-text">4 NFS工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-rpcinfo"><span class="toc-text">4.1 rpcinfo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-exportfs"><span class="toc-text">4.2 exportfs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-showmount"><span class="toc-text">4.3 showmount</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-mount-nfs"><span class="toc-text">4.4 mount.nfs</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-NFS%E5%85%B1%E4%BA%AB%E5%AE%9E%E7%8E%B0"><span class="toc-text">5 NFS共享实现</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E7%9B%AE%E6%A0%87"><span class="toc-text">5.1 目标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-text">5.2 环境准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-%E6%AD%A5%E9%AA%A4"><span class="toc-text">5.3 步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-1-%E5%9C%A8%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE%E5%85%B1%E4%BA%AB"><span class="toc-text">5.3.1 在服务端配置共享</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-2-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE"><span class="toc-text">5.3.2 客户端配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-3-%E7%94%A8%E6%88%B7%E6%98%A0%E5%B0%84"><span class="toc-text">5.3.3 用户映射</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-4-%E7%BB%9F%E4%B8%80%E7%94%A8%E6%88%B7%E6%98%A0%E5%B0%84"><span class="toc-text">5.3.4 统一用户映射</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E5%9F%BA%E4%BA%8ELAMP%E6%9E%B6%E6%9E%84%EF%BC%8C%E9%80%9A%E8%BF%87NFS%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%85%B1%E4%BA%AB%E5%AD%98%E5%82%A8%EF%BC%8C%E5%B9%B6%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5%E5%88%B0%E5%A4%87%E4%BB%BD%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">6 基于LAMP架构，通过NFS实现数据共享存储，并实时同步到备份服务器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E9%85%8D%E7%BD%AEDNS"><span class="toc-text">6.1 配置DNS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-%E9%85%8D%E7%BD%AEWeb1%E5%92%8CMySQL"><span class="toc-text">6.2 配置Web1和MySQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-%E9%85%8D%E7%BD%AENFS"><span class="toc-text">6.3 配置NFS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-%E9%85%8D%E7%BD%AEWeb2"><span class="toc-text">6.4 配置Web2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-5-%E9%85%8D%E7%BD%AEbackup"><span class="toc-text">6.5 配置backup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-6-%E6%B5%8B%E8%AF%95"><span class="toc-text">6.6 测试</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/Kubernetes/deploy/cluster/" title="集群管理指南"><img src="/img/paper1.jpg" onerror="this.onerror=null;this.src='/img/error-page.png'" alt="集群管理指南"/></a><div class="content"><a class="title" href="/Kubernetes/deploy/cluster/" title="集群管理指南">集群管理指南</a><time datetime="2025-09-21T02:38:40.000Z" title="发表于 2025-09-21 10:38">2025-09-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/CICD/ansible/role/" title="Role角色"><img src="/img/paper4.png" onerror="this.onerror=null;this.src='/img/error-page.png'" alt="Role角色"/></a><div class="content"><a class="title" href="/CICD/ansible/role/" title="Role角色">Role角色</a><time datetime="2025-09-13T10:07:53.000Z" title="发表于 2025-09-13 18:07">2025-09-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/CICD/ansible/playbook/" title="PlayBook"><img src="/img/paper5.png" onerror="this.onerror=null;this.src='/img/error-page.png'" alt="PlayBook"/></a><div class="content"><a class="title" href="/CICD/ansible/playbook/" title="PlayBook">PlayBook</a><time datetime="2025-09-13T10:07:48.000Z" title="发表于 2025-09-13 18:07">2025-09-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/CICD/ansible/module/" title="常用模块"><img src="/img/paper6.png" onerror="this.onerror=null;this.src='/img/error-page.png'" alt="常用模块"/></a><div class="content"><a class="title" href="/CICD/ansible/module/" title="常用模块">常用模块</a><time datetime="2025-09-13T10:07:42.000Z" title="发表于 2025-09-13 18:07">2025-09-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/CICD/ansible/command/" title="相关命令"><img src="/img/paper3.png" onerror="this.onerror=null;this.src='/img/error-page.png'" alt="相关命令"/></a><div class="content"><a class="title" href="/CICD/ansible/command/" title="相关命令">相关命令</a><time datetime="2025-09-13T10:07:38.000Z" title="发表于 2025-09-13 18:07">2025-09-13</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Aquarius</span></div><div class="footer_custom_text"><style>
div#runtime {
  font-size: 13px;
  font-weight: bold;
}

div#ghbdages_list {
  height: 1.5rem;
  display: flex;
  justify-content: center;
  align-items: center;
  margin-top: 10px
}

.github-badge {
  display: flex;
  align-items: center;
  margin-inline: 6px;
}
</style>
<div id="runtime"></div>
<div id="ghbdages"></div>
<script>
  function createtime() {
    const now = new Date();
    const grt = new Date("08/01/2025 00:00:00"); // 网站诞生时间

    // 计算天、小时、分钟和秒
    const days = Math.floor((now - grt) / (1000 * 60 * 60 * 24));
    const hours = Math.floor(((now - grt) / (1000 * 60 * 60)) % 24)
      .toString()
      .padStart(2, "0");
    const minutes = Math.floor(((now - grt) / (1000 * 60)) % 60)
      .toString()
      .padStart(2, "0");
    const seconds = Math.floor(((now - grt) / 1000) % 60)
      .toString()
      .padStart(2, "0");

    // HTML 输出
    const currentTimeHtml = `
          <div>
              本站已运行 ${days} 天 ${hours} 小时 ${minutes} 分 ${seconds} 秒 
          </div>`;

    const runtime = document.getElementById("runtime");
    if (runtime) runtime.innerHTML = currentTimeHtml;
  }

  // 设置每秒调用函数
  setInterval(createtime, 1000);

  function renderBadge() {
    const currentTimeHtml = `
      <div id="ghbdages_list">
          <a class="github-badge" target="_blank" href="https://hexo.io/" title="hexo:7.3.0">
              <img src="https://img.shields.io/badge/Frame-Hexo-blue?logo=hexo" alt="Static Badge">
          </a>
          <a class="github-badge" target="_blank" href="https://github.com/" title="github">
              <img src="https://img.shields.io/badge/Code-GitHub-181717?logo=GitHub&color=%23FF7102" alt="Static Badge">
          </a>
          <a class="github-badge" target="_blank" href="https://vercel.com/" title="vercel">
              <img src="https://img.shields.io/badge/Host-Vercel-%23F0D722?logo=Vercel" alt="Static Badge">
          </a>
          <a class="github-badge" target="_blank" href="https://analytics.sysio.ai/" title="umami">
              <img src="https://img.shields.io/badge/Analytics-Umami-%237FB100?logo=umami&logoColor=%237FB100" alt="Static Badge">
          </a>
      </div>`;

    const ghbdages = document.getElementById("ghbdages");
    if (ghbdages) {
      ghbdages.innerHTML = currentTimeHtml;
    }
  }

  window.onload = renderBadge;
</script>
</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://unpkg.com/@fancyapps/ui/dist/fancybox/fancybox.umd.js"></script><script src="https://unpkg.com/instant.page/instantpage.js" type="module"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://unpkg.com/mathjax/es5/tex-mml-chtml.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'forest'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://unpkg.com/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://cdn.jsdelivr.net/gh/xiabo2/CDN@latest/fishes.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://unpkg.com/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章..." type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>